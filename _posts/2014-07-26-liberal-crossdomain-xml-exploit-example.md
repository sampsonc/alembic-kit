---
title: 'Liberal Crossdomain.xml Exploit Example - Part 1'
date: 2014-07-26T21:47:25+00:00
author: chs
layout: post
permalink: /liberal-crossdomain-xml-exploit-example/
categories:
  - Security
---
So, I decided to whip up this PoC of a liberal crossdomain.xml policy and what you can do with it. It&#8217;s been on my mind recently and thought a tangible example would help solidify in mind some of the possibilities. First, the basics-

### What is a crossdomain.xml file?

A crossdomain.xml file essentially lets a domain specify the domains from which flash applets are loaded that are allowed to access it. The domain(s) that the crossdomain.xml file specifies are the domain from which the applet is loaded, not the domain that references the flash file.

### Why does this matter?

Keep in mind that when a flash applet makes a call to retrieve data from a domain, the browser includes any cookies for that domain with the call. So, if it&#8217;s a domain that you&#8217;re authenticated with, then the flash applet will have the same access to that domain as the user does when accessing the site.

### A working example

There are 2 domains for this example- rubysecurity.info and injectionvector.com. These are both domains that I own and have used for this demo.

Try going to <a href="http://rubysecurity.info/login/info.php" title="http://rubysecurity.info/login/info.php" target="_blank">http://rubysecurity.info/login/info.php</a>. You will get a message that looks like this-

<pre lang="xml">You are not logged in. Please login
</pre>

because you are not logged in. That page requires you to be authenticated to view it. (In this cause &#8220;authenticated&#8221; means a cookie is set with your username:password in it)

Then go to <a href="http://rubysecurity.info/login" title="http://rubysecurity.info/login" target="_blank">http://rubysecurity.info/login</a> and input anything as the user name and anything as the password. In my example, I used &#8220;chs&#8221; for both. You will be redirected to <a href="http://rubysecurity.info/login/info.php" title="http://rubysecurity.info/login/info.php" target="_blank">http://rubysecurity.info/login/info.php</a> with a message that looks like-

<pre lang="xml">Thanks for logging in! Your credentials are: chs:chs. Do not share them with others.  You must be authenticated to view this page.
</pre>

Since you are authenticated, it lets you get to that page and shows you your username:password in this example. In a real world site it could be a page that shows you bank balances, sensitive data, etc.

Now, in another browser tab open <a href="http://injectionvector.com/flasher" title="http://injectionvector.com/flasher" target="_blank">http://injectionvector.com/flasher</a>. It appears that nothing happens. But, in the background it connected to <a href="http://rubysecurity.info/login/info.php" title="http://rubysecurity.info/login/info.php" target="_blank">http://rubysecurity.info/login/info.php</a>, got the response, and logged it.

You can see the results at <a href="http://injectionvector.com/flasher/readlog.php" title="http://injectionvector.com/flasher/readlog.php" target="_blank">http://injectionvector.com/flasher/readlog.php</a>

Currently it looks like-

<pre lang="xml">Thanks for logging in! Your credentials are: chs:chs. Do not share them with others. You must be authenticated to view this page.
</pre>

So, the flash applet that I wrote on <a href="http://injectionvector.com/flasher" title="http://injectionvector.com/flasher" target="_blank">http://injectionvector.com/flasher</a> connected to <a href="http://rubysecurity.info/login/info.php" title="http://rubysecurity.info/login/info.php" target="_blank">http://rubysecurity.info/login/info.php</a> and pulled the content utilizing your existing session with rubysecurity.info.

### Why did that happen?

The reason this happened was because rubysecurity.info had a liberal crossdomain.xml policy. In this example, it lets any flash applet connect. It looks like-

<pre lang="xml"><?xml version="1.0"?>

&lt;cross-domain-policy>
&lt;allow-access-from domain="*"/>
&lt;/cross-domain-policy>
</pre>

When a flash applet tries to connect to a domain, the flash container attempts to retrieve crossdomain.xml and applies the policy it contains. Since the above one allows access from any domain, the flash applet from injectionvector.com was allowed to connect, access the page, and log the results.

[Part 2](//chs.us/liberal-crossdomain-xml-example-part-2 "Part 2")
